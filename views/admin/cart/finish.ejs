<%-include('../../partials/header') %>
<%-include('../../partials/navbarlogin') %>
<%-include('../../partials/navbarlogo') %>
<%-include('../../partials/navbarmenu') %>


<div class="container-fluid mt-3">
    <div class="card">
        <div class="card-header">Cliente</div>
        <div class="card-body">
            <div class="row">
                <div class="col">Nome <%= ord.cliente.nome %> </div>
                <div class="col">Cpf <%= ord.cliente.cnpjCpf %></div>
                <div class="col">Email <%= ord.cliente.email %></div>
            </div>
            <div class="row">
                <div class="col">Contato <%= ord.cliente.tel %></div>
                <div class="col">Tel <%= ord.cliente.cel1 %></div>
                <div class="col">Tel <%= ord.cliente.cel2 %></div>
            </div>
        </div>

    </div>
    <div class="card mt-3">
        <div class="card-header">Pedido</div>
        <div class="card-body">
            <div class="row">
                <div class="col">Total: <%= parseFloat(ord.total).toLocaleString('pt-br',{style: 'currency', currency: 'BRL'}) %> </div>
                <div class="col">Frete: <%= parseFloat(ord.valorFrete).toLocaleString('pt-br',{style: 'currency', currency: 'BRL'}) %> </div>
                <div class="col">Data: <%= `${ord.createdAt.getDate()}/${ord.createdAt.getMonth()+1}/${ord.createdAt.getFullYear()}` %></div>
            </div>
            <hr>
            <h6 class="text-center">Itens do Pedido</h6>
            <div class="table-responsive container">
                <table class="table table-borderless">
                    <thead>
                        <tr>
                            <th scope="col">Cod</th>
                            <th scope="col">Produto</th>
                            <th scope="col">Qtd</th>
                            <th scope="col">Altura</th>
                            <th scope="col">Largura</th>
                            <th scope="col">Valor</th>

                        </tr>
                    </thead>
                    <tbody>
                        <% itens.forEach(item=>{%>
                        <tr>
                            <td><%= item.id %> </td>
                            <td><%= item.produto.nome %> </td>
                            <td><%= item.qtd %></td>
                            <td><%= item.altura!=null?item.altura:'---' %> </td>
                            <td><%= item.largura!=null?item.largura:'---' %> </td>
                            <td><%= parseFloat(item.valor).toLocaleString('pt-br',{style: 'currency', currency: 'BRL'}) %></td>
                        </tr>
                        <%})%>


                    </tbody>
                </table>
            </div>

        </div>
        <div class="card-footer">Total: <%= parseFloat(ord.valorFinal).toLocaleString('pt-br',{style: 'currency', currency: 'BRL'})%></div>
    </div>
    <div class="card mt-3">
        <div class="card-header">Endereço de entrega
            <button data-toggle="modal" data-target="#exampleModal" class="btn btn-primary btn-sm">Mudar endereço de
                Entrega</button>
        </div>

        <div class="card-body">
            <div class="row">
                <div class="col-md-3 offset-md-3">
                    <span style="font-weight: bold;">Endereço:</span>
                    <%=(ord.enderecoId>0)?ord.endereco.rua:ord.cliente.rua %>
                </div>
                <div class="col-md-3">
                    <span style="font-weight: bold;">Bairro:</span>
                    <%=(ord.enderecoId>0)?ord.endereco.bairro:ord.cliente.bairro %>
                </div>
                <div class="col-md-3">
                    <span style="font-weight: bold;">Nº:</span>
                    <%=(ord.enderecoId>0)?ord.endereco.numero:ord.cliente.numero %>
                </div>
            </div>
            <div class="row">

                <div class="col-md-3 offset-md-3">
                    <span style="font-weight: bold;">Cep:</span>
                    <%=(ord.enderecoId>0)?ord.endereco.cep:ord.cliente.cep %>
                </div>
                <div class="col-md-3">
                    <span style="font-weight: bold;">Cidade:</span>
                    <%=(ord.enderecoId>0)?ord.endereco.cidade:ord.cliente.cidade %>
                </div>
                <div class="col-md-3">
                    <span style="font-weight: bold;">UF:</span> <%=(ord.enderecoId>0)?ord.endereco.uf:ord.cliente.uf %>
                </div>
            </div>
            <div class="row">
                <div class="col-md-3 offset-md-3">
                    <span style="font-weight: bold;">Complemento:</span>
                    <%=(ord.enderecoId>0)?ord.endereco.complemento:ord.cliente.complemento %>
                </div>
            </div>
        </div>

    </div>
    <div id="areaPagamento">
        <div class="row">
            <div class="col text-center">
                <form action="/payer" method="post">
                    <script src="https://www.mercadopago.com.br/integrations/v1/web-payment-checkout.js"
                        data-preference-id='<%= global.id %>'
                        data-button-label="Confirmar informações acima e realizar o pagamento">
                        </script>
                </form>
                <button class="btn btn-outline-primary mt-3">Cancelar Confirmação de pagamento</button>
            </div>
        </div>
    </div>
</div>

<!----------------Modal-------------------->
<%- include('../../partials/cart/modalEndereco') %>




<%- include('../../partials/footer') %>

<script src="/js/ajax.js"></script>
<script src="/js/modalAlterarEndereco.js"></script>


<script>

    let btnMercadoPago = document.querySelector('.mercadopago-button')
    console.dir(btnMercadoPago)
    btnMercadoPago.classList.add('btn')
    btnMercadoPago.classList.add('mt-3')
    btnMercadoPago.classList.add('btn-primary')
    //btnMercadoPago.classList.remove('mercadopago-button')
</script>