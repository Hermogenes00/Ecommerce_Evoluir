<%- include('../../partials/header') %>
<%- include('../../partials/navbarhome') %>


<div class="container mt-3">

    <% if(message.error.length>0){%>
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        <strong>Erro</strong> <%=message.error%>.
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <%} %>
    <% if(message.success.length>0){%>
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        <strong>Parabéns</strong> <%=message.success%>.
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <%} %>

    <div class="card">
        <div class="card-header"><span class="display-4">Meu carrinho</span></div>
        <% if(ord){%>
        <div class="card-body">
            <table class="table table-sm table-borderless">
                <thead class="thead-dark">
                    <tr>
                        <th>#</th>
                        <th>Status</th>
                        <th>Valor</th>
                        <th>Frete</th>
                        <th>Total</th>
                        <th class="text-center"></th>
                    </tr>
                </thead>
                <tbody>

                    <tr>

                        <td>
                            <a href="#">
                                <h6 data-id="<%= ord.id %>" onclick="onClick(event)">Ver itens</h6>
                            </a>
                        </td>
                        <td>
                            <h6><%= ord.status %></h6>
                        </td>
                        <td>
                            <h6 id="valorSFrete" data-valorsfrete="<%= ord.total %>"><%= ord.total %></h6>
                        </td>
                        <td>
                            <h6 id="valorFrete"><%= parseFloat(ord.valorFrete).toLocaleString('pt-br') %></h6>
                        </td>
                        <td>
                            <h6 id="valorFinal"><%= parseFloat(ord.valorFinal).toLocaleString('pt-br') %></h6>
                        </td>
                        <td>

                            <div class="row">
                                <div class="col-md-2 offset-md-4">
                                    <form onsubmit="remover(event,this,'Deseja realmente limpar o carrinho?')"
                                        method="POST" action="/admin/cart/delete">
                                        <input type="hidden" name="idOrder" value="<%= ord.id %>">
                                        <button data-toggle="tooltip" title="Limpar Carrinho" type="submit"
                                            class=" btn btn-outline-primary material-icons">cleaning_services</button>

                                    </form>
                                </div>
                                <div class="col-md-2">

                                    <form onsubmit="remover(event,this,'Deseja realmente finalizar o carrinho?')"
                                        action="/cart/finish/" method="POST">
                                        <input type="hidden" name="idAddress" value="<%= ord.endereco.id %>">
                                        <input type="hidden" name="idOrder" value="<%= ord.id %>">
                                        <button type="submit" data-toggle="tooltip" title="Finalizar Carrinho"
                                            class=" btn btn-outline-primary material-icons">send</button>
                                    </form>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="6">
                            <div class="row">
                                <div id="conteudo<%= ord.id %>" class="col" style="display: none;"> </div>
                            </div>
                        </td>
                    </tr>



                </tbody>
            </table>
        </div>
        <div class="card-footer">
            <div class="row">
                <div class="col">
                    <small style="font-weight: bold;">Endereço de Entrega</small>
                    <small>Rua:<%=ord.endereco.rua %> | Bairro: <%=ord.endereco.bairro %> | Nº:
                        <%=ord.endereco.numero %> | Cidade: <%=ord.endereco.cidade %> | Uf: <%=ord.endereco.uf %> | Cep:
                        <%=ord.endereco.cep %></small>
                </div>
                <div class="col-md-2">
                    <button class="btn btn-primary btn-sm" data-toggle="modal" data-target="#exampleModal">Mudar Endereço</button>
                </div>
            </div>

        </div>
    </div>

    <!--Modal Endereço-->
    <%- include('../../partials/cart/modalEndereco') %>


    <div class="card mt-2">
        <div class="card-header">
            <h5>Método de Envio</h5>
        </div>
        <div class="card-body">
            <table class=" table table-hover">
                <thead>
                    <tr>
                        <th scope="col">Tipos de Entrega</th>
                        <th scope="col">Prazo de Entrega</th>
                        <th scope="col">Valor</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input type="radio" onclick="calcPrecoPrazo(event)"
                                <%=ord.metodoEnvio=='BALCAO'?'checked':'' %> data-idOrder="<%=ord.id %>" value="BALCAO"
                                name="radio_metodo" id="radio_metodo"> RETIRAR NO BALCÃO</td>
                        <td>De 3 dias úteis à 5 dias úteis, após a produção do último item</td>
                        <td>0,00</td>
                    </tr>
                    <tr>
                        <td>
                            <input type="radio" data-idOrder="<%=ord.id %>" onclick="calcPrecoPrazo(event)"
                                value="PAC_VISTA" <%=ord.metodoEnvio=='PAC_VISTA'?'checked':'' %> name="radio_metodo"
                                id="radio_metodo"> PAC
                        </td>
                        <td>....</td>
                        <td>....</td>
                    </tr>
                    <tr>
                        <td><input type="radio" data-idOrder="<%=ord.id %>" onclick="calcPrecoPrazo(event)"
                                value="SEDEX_VISTA" <%=ord.metodoEnvio=='SEDEX_VISTA'?'checked':'' %>
                                name="radio_metodo" id="radio_metodo"> SEDEX</td>
                        <td>....</td>
                        <td>....</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="card-footer">
            <div class="row">
                <div class="col offset-md-10">
                    <form onsubmit="remover(event,this,'Deseja realmente finalizar o carrinho?')" action="/cart/finish/"
                        method="POST">
                        <input type="hidden" name="idAddress" value="<%= ord.endereco.id %>">
                        <input type="hidden" name="idOrder" value="<%= ord.id %>">
                        <button type="submit" data-toggle="tooltip" title="Finalizar Carrinho"
                            class=" btn btn-outline-primary">Finalizar Carrinho</button>
                    </form>
                </div>
            </div>

        </div>
    </div>
    <%} %>
</div>
</div>


<%- include('../../partials/footer') %>


<script src="/js/ajax.js"></script>
<script src="/js/cart.js"></script>